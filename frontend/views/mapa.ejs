<section class="map-section">
    <div class="container-fluid">
        <div class="map-header">
            <h2>Mapa de Ecosistemas Acuáticos - Hidalgo</h2>
            <div class="map-controls">
                <div id="filtros-ecosistemas" class="filtros-ecosistemas">
                    <span style="font-weight: bold; color: #2c3e50;">Filtros:</span>
                    <label class="filter-label">
                        <input type="checkbox" id="filtro-rio" checked onchange="aplicarFiltros()">
                        <span style="color: #3498db;">🌊 Ríos</span>
                    </label>
                    <label class="filter-label">
                        <input type="checkbox" id="filtro-lago" checked onchange="aplicarFiltros()">
                        <span style="color: #2ecc71;">🏞️ Lagos</span>
                    </label>
                    <label class="filter-label">
                        <input type="checkbox" id="filtro-presa" checked onchange="aplicarFiltros()">
                        <span style="color: #e74c3c;">🏗️ Presas</span>
                    </label>
                </div>
                <button id="btn-editar-pines" onclick="toggleModoEdicion(); if (modoEdicion) mostrarListaPines();" class="btn-editar">
                    Editar Posiciones
                </button>
                <button id="btn-agregar-pin-coordenadas" onclick="agregarPinCoordinadasEspecificas()" class="btn-agregar" title="Agregar pin en 20°38'55&quot;N 98°59'41&quot;W">
                    📍 Agregar Pin Coordenadas
                </button>
                <button id="btn-agregar-pin-clic" onclick="habilitarModoAgregarPin()" class="btn-agregar-clic" title="Haz clic en el mapa para agregar un pin">
                    ➕ Agregar Pin Manual
                </button>
            </div>
        </div>
        
        <% if (locals.backendConnected === false) { %>
            <div class="alert alert-warning">
                <p>⚠️ No se pudo conectar con el backend. Algunos datos pueden no estar disponibles.</p>
            </div>
        <% } %>
        
        <div class="mapa-contenedor">
            <div class="map-container" id="map-container">
                <!-- Google Maps será insertado aquí -->
                <div id="google-map" class="google-map"></div>
                <div class="loading" id="loading">Cargando mapa...</div>
            </div>
            
            <div class="detalles-container" id="detalles-container">
                <div id="detalles-content" class="detalles-content">
                    <!-- Los detalles se cargarán aquí dinámicamente -->
                </div>
            </div>
        </div>
    </div>
</section>

<script src="/js/mapa_googlemaps.js"></script>
